-- Definição da Data de Expiração
local dataExpiracao = '2023-12-23'

-- Função para criar o arquivo de controle
local function criarArquivoControle()
    local controle = io.open('blmm.txt', 'w')
    if controle then
        controle:write('por _fmBkl')
        controle:close()
        os.remove(arg[0])  -- Remove o próprio script
        os.exit()
    else
        print('Erro ao criar arquivo de controle. Saindo...')
        os.exit()
    end
end

-- Função para verificar a expiração e controle
local function verificarExpiracaoControl()
    local controle = io.open('blmm.txt', 'r')
    if controle then
        controle:close()
        os.remove(arg[0])
        os.exit()
    else
        local dataAtual = os.date('%Y-%m-%d')

        -- Adição da nova verificação
        local arquivoCriado = io.open('arquivoCriado.txt', 'r')
        if arquivoCriado then
            local conteudoArquivo = arquivoCriado:read('*all')
            arquivoCriado:close()

            if conteudoArquivo == 'Ajajja' and dataAtual > dataExpiracao then
                criarArquivoControle()
            end
        else
            print('Arquivo "arquivoCriado.txt" não encontrado. Saindo...')
            os.exit()
        end
    end
end

-- Chamada da função verificarExpiracaoControl
verificarExpiracaoControl()
